# Supabase ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ìŠ¤í¬ë¦½íŠ¸

ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Supabase ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë“  í…Œì´ë¸”ì„ CSV íŒŒì¼ë¡œ ë°±ì—…í•©ë‹ˆë‹¤.

## ğŸ“‹ ë°±ì—…ëœ í…Œì´ë¸”

- `companies` - ì—…ì²´ ì •ë³´
- `products` - ì œí’ˆ ì •ë³´  
- `clients` - ê³ ê° ì •ë³´
- `pharmacies` - ì•½êµ­ ì •ë³´
- `wholesale_sales` - ë„ë§¤ ë§¤ì¶œ ì •ë³´
- `direct_sales` - ì§ê±°ë˜ ë§¤ì¶œ ì •ë³´
- `performance_records` - ì‹¤ì  ê¸°ë¡
- `settlement_months` - ì •ì‚° ì›” ì •ë³´
- `notices` - ê³µì§€ì‚¬í•­

## ğŸš€ ì‚¬ìš©ë²•

### 1. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip3 install supabase pandas python-dotenv
```

### 2. ë°±ì—… ì‹¤í–‰

#### ê°„ë‹¨í•œ ë°©ë²•:
```bash
python3 backup_database_improved.py
```

#### ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©:
```bash
chmod +x run_backup.sh
./run_backup.sh
```

## ğŸ“ ë°±ì—… ê²°ê³¼

ë°±ì—…ì´ ì™„ë£Œë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤:

```
database_backup_YYYYMMDD_HHMMSS/
â”œâ”€â”€ backup_summary.json          # ë°±ì—… ìš”ì•½ ì •ë³´
â”œâ”€â”€ companies.csv                # ì—…ì²´ ì •ë³´
â”œâ”€â”€ products.csv                 # ì œí’ˆ ì •ë³´
â”œâ”€â”€ clients.csv                  # ê³ ê° ì •ë³´
â”œâ”€â”€ pharmacies.csv               # ì•½êµ­ ì •ë³´
â”œâ”€â”€ wholesale_sales.csv          # ë„ë§¤ ë§¤ì¶œ ì •ë³´
â”œâ”€â”€ direct_sales.csv             # ì§ê±°ë˜ ë§¤ì¶œ ì •ë³´
â”œâ”€â”€ performance_records.csv      # ì‹¤ì  ê¸°ë¡
â”œâ”€â”€ settlement_months.csv        # ì •ì‚° ì›” ì •ë³´
â””â”€â”€ notices.csv                  # ê³µì§€ì‚¬í•­
```

## ğŸ“Š ë°±ì—… ìš”ì•½ ì •ë³´

`backup_summary.json` íŒŒì¼ì—ëŠ” ë‹¤ìŒ ì •ë³´ê°€ í¬í•¨ë©ë‹ˆë‹¤:

```json
{
  "backup_timestamp": "2025-07-24T15:58:18.582205",
  "total_tables": 9,
  "successful_backups": 9,
  "failed_backups": 0,
  "backup_directory": "database_backup_20250724_155818",
  "tables": ["companies", "products", ...],
  "supabase_url": "https://selklngerzfmuvagcvvf.supabase.co"
}
```

## âš™ï¸ ì„¤ì •

ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì—ì„œ ë‹¤ìŒ ì„¤ì •ì„ í™•ì¸/ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
SUPABASE_URL = "https://selklngerzfmuvagcvvf.supabase.co"
SUPABASE_ANON_KEY = "your-anon-key-here"
```

## ğŸ”§ ë¬¸ì œ í•´ê²°

### í…Œì´ë¸”ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°
- ìŠ¤í¬ë¦½íŠ¸ëŠ” ìë™ìœ¼ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í…Œì´ë¸”ì„ ê±´ë„ˆëœë‹ˆë‹¤
- ì‹¤ì œ ì¡´ì¬í•˜ëŠ” í…Œì´ë¸”ë§Œ ë°±ì—…ë©ë‹ˆë‹¤

### ë°ì´í„°ê°€ ì—†ëŠ” í…Œì´ë¸”
- ë°ì´í„°ê°€ ì—†ëŠ” í…Œì´ë¸”ì€ ë¹ˆ CSV íŒŒì¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤
- `no_data` í—¤ë”ê°€ í¬í•¨ë©ë‹ˆë‹¤

### ê¶Œí•œ ì˜¤ë¥˜
- Supabase anon keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ì„¸ìš”
- í…Œì´ë¸”ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **ë°ì´í„° ì œí•œ**: ê° í…Œì´ë¸”ë‹¹ ìµœëŒ€ 10,000ê°œ í–‰ë§Œ ë°±ì—…ë©ë‹ˆë‹¤
2. **ì¸ì½”ë”©**: ëª¨ë“  CSV íŒŒì¼ì€ UTF-8 ì¸ì½”ë”©ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤
3. **ë°±ì—… ìœ„ì¹˜**: í˜„ì¬ ë””ë ‰í† ë¦¬ì— íƒ€ì„ìŠ¤íƒ¬í”„ê°€ í¬í•¨ëœ í´ë”ê°€ ìƒì„±ë©ë‹ˆë‹¤
4. **ë³´ì•ˆ**: Supabase í‚¤ê°€ ìŠ¤í¬ë¦½íŠ¸ì— í•˜ë“œì½”ë”©ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì£¼ì˜í•˜ì„¸ìš”

## ğŸ”„ ìë™í™”

ì •ê¸°ì ì¸ ë°±ì—…ì„ ìœ„í•´ cron jobì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# ë§¤ì¼ ìƒˆë²½ 2ì‹œì— ë°±ì—… ì‹¤í–‰
0 2 * * * cd /path/to/project && python3 backup_database_improved.py
``` 